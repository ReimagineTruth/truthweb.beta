<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Payment - TruthWeb</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>
    <!-- Copy styles from product-view.html -->
</head>
<body>
    <!-- Copy header, mobile menu, and footer from product-view.html -->
    <main class="max-w-6xl mx-auto py-16 px-4">
        <h1 class="text-3xl font-bold mb-8">Payment</h1>
        <div id="cart-summary" class="card mb-8"></div>
        <button id="pay-now" class="btn w-full">Pay Now</button>
    </main>
    <!-- Copy footer-menu and footer from product-view.html -->
    <script>
      fetch('/api/cart')
        .then(response => response.json())
        .then(cart => {
          const summary = document.getElementById('cart-summary');
          let total = 0;
          summary.innerHTML = cart.map(item => {
            total += item.price * item.quantity;
            return `<p>${item.title} - ${item.quantity} x ${item.price} Pi = ${item.price * item.quantity} Pi</p>`;
          }).join('') + `<p class="font-bold mt-4">Total: ${total} Pi</p>`;
          document.getElementById('pay-now').addEventListener('click', () => {
            fetch('/api/payment', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ cartItems: cart })
            })
              .then(response => response.json())
              .then(data => {
                if (data.success) alert('Payment successful!');
                window.location.href = '/digitalproducts.html';
              });
          });
        });
    </script>
</body>
</html>
