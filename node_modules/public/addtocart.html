<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Cart - TruthWeb</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>
    <!-- Copy styles from product-view.html -->
</head>
<body>
    <!-- Copy header, mobile menu, and footer from product-view.html -->
    <main class="max-w-6xl mx-auto py-16 px-4">
        <h1 class="text-3xl font-bold mb-8">Your Cart</h1>
        <div id="cart-items" class="space-y-4"></div>
        <div class="mt-8">
            <p id="total" class="text-lg font-bold mb-4">Total: 0 Pi</p>
            <a href="/payment.html" class="btn w-full" id="proceed-to-payment">Proceed to Payment</a>
        </div>
    </main>
    <!-- Copy footer-menu and footer from product-view.html -->
    <script>
      // Fetch cart contents
      fetch('/api/cart')
        .then(response => response.json())
        .then(cart => {
          const cartItems = document.getElementById('cart-items');
          let total = 0;
          cartItems.innerHTML = cart.map(item => {
            total += item.price * item.quantity;
            return `
              <div class="card flex items-center justify-between">
                <div>
                  <h3 class="text-xl font-semibold">${item.title}</h3>
                  <p>Price: ${item.price} Pi x ${item.quantity}</p>
                </div>
                <p class="font-bold">${item.price * item.quantity} Pi</p>
              </div>
            `;
          }).join('');
          document.getElementById('total').textContent = `Total: ${total} Pi`;
        });

      // Add product to cart from URL
      const urlParams = new URLSearchParams(window.location.search);
      const productId = urlParams.get('productId');
      if (productId) {
        fetch('/api/cart', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ productId })
        })
          .then(() => window.location.href = '/addtocart.html'); // Refresh page
      }
    </script>
</body>
</html>
